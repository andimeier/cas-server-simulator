# Mock CAS Server

This is a CAS server implementation targeted as a simple mock, but still functional. The CAS servers follows the specification of https://apereo.github.io/cas/4.2.x/protocol/CAS-Protocol.html. The used CAS protocol version is 2.0.

Proxy handling is not implemented, only the SSO login process (routes `/login` and `/serviceValidate` in CAS 2.0).

Features:

* simulate successful login, returning a service ticket
* validate service ticket

It can be used during development for your CAS aware application if you need a simple mock CAS service.

## Authentication

A main functionality of a CAS server is handling the actual login process. This mock CAS server does not really hold a credential server.

Instead, a mock login screen lets you enter any username (user ID) you like. You will be authenticated successfully and the mock CAS server will return the user ID you entered as the CAS login user ID. 

## Functions

### Login

The `/login` path will simulate the results of a successful login session: a redirect to the given service will be issued. A newly generated service ticket will be appended in the target URL (service URL) as a query parameter.

### Ticket validation

Service tickets generated by a `/login` are memorized over a expiry period of 5 minutes. When a ticket is validated via `/serviceValidate`, a valid service ticket must be presented. In other words, a ticket which has not been used so far for any operation and which is less than 5 minutes old.

### Single logout (SLO)

An `/logout`, all registered services (ie, all services which have previously requested authentication) will be notified via POST request about the logout. 

## Start

Use the following command to start the server:

    npm start

The console output will tell you the port number (as it is configured in `app/config/config.js`).

## Usage

To check if the CAS server is working and waiting to be used, enter a URL like this in the browser:

    http://localhost:3003/login?service=http%3A%2F%2Fservice.example.com%3A3002%2Fcas

Note that you need a service, otherwise the CAS server will complain. 